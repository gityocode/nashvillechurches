
<!-- Include Google Maps JavaScript API -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCmBnKTeHu-tkSurV2BBc22Rpt9XeEZOv8"></script>

<!-- Include Marker Clusterer library -->
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js"></script>

<!-- Include Font Awesome library (updated to latest version) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<!-- Initialize Map -->
<script>
function initMap() {
  const map = new google.maps.Map(document.getElementById('map'), {
    zoom: 11,
    center: {lat: 36.161091, lng: -86.778514}, 
    mapId: '18bb2aceb768448d' 
  });

  var markers = [];
  var infoWindow = new google.maps.InfoWindow(); // Declare infoWindow here

  fetch('https://storage.googleapis.com/sincere-chariot-355204.appspot.com/Places-Export%20to%20JSON%202023-12-12b.geojson')
    .then(function(response){
      return response.json();
    })
    .then(function(data){
      data.features.forEach(function(feature){
        // Create a div for the Font Awesome icon
        var icon = document.createElement('div');
        icon.innerHTML = '<i class="fas fa-church fa-lg"></i>';
        icon.style.fontSize = '24px'; // Adjust icon size

        // Create a marker with the Font Awesome icon
        var marker = new google.maps.Marker({
          position: {
            lat: feature.geometry.coordinates[1],
            lng: feature.geometry.coordinates[0]
          },
          map: map,
          icon: {
            url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(icon.outerHTML),
            scaledSize: new google.maps.Size(30, 30) // Adjust icon size on the map
          }
        });

        markers.push(marker);

        // Add a click listener for each marker
        marker.addListener('click', function() {
          // Close the current infoWindow
          infoWindow.close();
          
          // Create new infoWindow content
          infoWindow.setContent('<h3>' + feature.properties.PlaceName + '</h3>' +
            '<p><b>Website:</b> <a href="' + feature.properties.website + '" target="_blank" style="color:blue;">' + feature.properties.website + '</a></p>' +
            '<p><b>Address:</b> ' + feature.properties.FullAddress + '</p>' +
            '<p><b>Phone Number:</b> ' + feature.properties.phone_number + '</p>' +
            '<p><i class="fas fa-map-marked-alt fa-lg"></i> <a href="' + feature.properties.GoogleMapsPlaceIDurl + '" target="_blank" style="color:blue;">Open in Google Maps</a></p>');
          
          // Open the infoWindow at the marker
          infoWindow.open(map, marker);
        });
      });

      new MarkerClusterer(map, markers, {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
    });
}

</script>

<!-- Your Map Container -->
<div id="map" style="width: 100%; height: 700px;"></div>

<style>
html, body {
  height: 100%;
  margin: 0;
  padding: 0;
}

#map {
  height: 100%;
}
</style>

